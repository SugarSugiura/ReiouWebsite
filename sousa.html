<!doctype html>
<html><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script defer="" src="https://cdn.jsdelivr.net/npm/shogi-player@1.1.1"></script>
  <style>
    html {
      overflow: hidden;
    }
 
  </style>
  <!-- <script defer src="../../dist/wc/production/shogi-player-wc.js"></script> -->
  <script>
    let item;
    let turn;
  </script>
  <script type="module">
    import { LitElement, css, html } from "https://cdn.jsdelivr.net/gh/lit/dist@2/core/lit-core.min.js"
    export class ShogiBoard extends LitElement {
      static styles = css`
        :host {
          display: block;
          /*border: 1px solid hsl(0 0% 0% / 0.1);*/
          padding: 1rem;
          height: 100%
        }
        .container {
          display: flex;
          justify-content: center;
          gap: 1rem;
        }
        shogi-player-wc {
          flex-basis: 97vh;
        }
        shogi-player-wc::part(root) {
          --sp_board_color: white;
        }
        .comment {
          border: 1px solid hsl(0 0% 0% / 0.10);
          background-color: hsl(0 0% 0% / 0.02);
          border-radius: 4px;
          flex-basis: 40vh;
          position: relative;
        }
        .comment-body {
          position: absolute;
          top: 1rem;
          left: 1rem;
          bottom: 1rem;
          right: 1rem;

          overflow-y: scroll;

          display: flex;
          flex-direction: column;
          gap: 1rem;
        }
        .comment-body p {
          margin: 0;
        }
      `

      static properties = {
        source: { type: String },
        comment_lines: { type: Array },
        turn: { type: String },
        pass_css: { type: String }
      }

      constructor() {
        super()
        this.source ??= "position sfen 4k4/9/9/9/9/9/9/9/9 b 2r2b4g4s4n4l18p 1"
        this.comment_lines = null
        this.turn = null
        this.pass_css = null
      }

      render() {
        return html`
          <div class="container">
            <shogi-player-wc
              sp_mode="play"
              sp_body="${this.source}"
              sp_comment="false"
              sp_event_log="false"
              sp_mobile_vertical="false"
              sp_piece_variant="paper"
              sp_turn="${this.turn}"
              @ev_comment_change="${e => this.comment_lines = e.detail[0]}"
              @ev_play_mode_move="${e => e.detail[0].sfen}"
              @ev_short_sfen_change="${e => item = e.detail[0]}"
              @ev_turn_offset_change="${e => turn = e.detail[0]}"
              @ev_turn_offset_max_change="${e => e.detail[0]}"
              sp_controller="false"
              sp_human_side="both"
              sp_dev_tools_position="left"
              sp_pass_css="${this.pass_css}"
            ></shogi-player-wc>
            <div class="comment">
              <div class="comment-body">
                ${(this.comment_lines || []).map(e => html`<p>${e}</p>`)}
              </div>
            </div>
          </div>
        `

        
      }

      

    }
    customElements.define("shogi-board", ShogiBoard);
    var elem = document.getElementById("shogi");

    

    setInterval(() => {
      if (turn == 1) {
        elem.setAttribute("turn", "2");
        elem.setAttribute("source", "position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/7P1/PPPPPPP1P/1B5R1/LNSGKGSNL b - 3 moves 3c3d");
      }
    }, 1000);

    //setInterval(() => console.log(item), 1000);
    setInterval(() => console.log(turn), 1000);
    //setInterval(() => console.log(elem.getAttribute("turn")), 1000);

    
    /*window.addEventListener("DOMContentLoaded", function(){
      // 0.100秒ごとに実行
     setInterval(() => {
      console.log(item);
     }, 1000);  //この値で何秒ごとに実行するかが決まる
   });*/

  </script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet" id="bdf2da9503326784806e006ec9c11bcf"></head>
<body>
  <input type="button" value="採点" onclick="EmphasizeSquare(5, 5)" style="position: absolute; top: 100px">
<shogi-board id="shogi"  source=""></shogi-board>

<script src="assets/js/test.js"></script>
</body></html>